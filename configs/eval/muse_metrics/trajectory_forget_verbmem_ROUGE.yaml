# @package _global_.eval.metrics.trajectory_forget_verbmem_ROUGE
# Trajectory-wrapped forget_verbmem_ROUGE - same metric/dataset as regular, computed at each diffusion step

defaults:
  - ../../data/datasets@datasets: MUSE_forget_verbmem
  - ../../collator@collators: DataCollatorForSupervisedDatasetwithIndex

handler: trajectory_metrics
batch_size: 1
metrics:
  - rouge
rouge_type: rougeL_f1
trajectory_config:
  logits_source: sampler
  return_logits: true
  return_fixation_steps: true
  sampler_kwargs:
    steps: 16
    temperature: 0.0
    max_new_tokens: 128

datasets:
  MUSE_forget_verbmem:
    args:
      hf_args:
        path: muse-bench/MUSE-${data_split}
        name: verbmem
        split: "forget[:5]"
      prefix_key: "prompt"
      text_key: "gt"
      max_length: 2048
      insert_space: True
      predict_with_generate: True

collators:
  DataCollatorForSupervisedDataset:
    args:
      padding_side: left
generation_args:
  max_new_tokens: 128
